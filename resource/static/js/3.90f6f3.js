(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{366:function(t,e,a){},367:function(t,e,a){"use strict";var r=a(366);a.n(r).a},368:function(t,e,a){"use strict";var r=function(){var a=this,t=a.$createElement,r=a._self._c||t;return r("div",{staticClass:"ui-bread-crumb"},[r("Breadcrumb",a._l(a.data,function(t,e){return r("BreadcrumbItem",{key:e},[a._v(a._s(t))])}),1)],1)};r._withStripped=!0;var i={props:{data:{type:Array,default:function(){return[]}}}},o=(a(367),a(47)),s=Object(o.a)(i,r,[],!1,null,null,null);s.options.__file="src/components/manage/common/bread-crumb.vue";e.a=s.exports},369:function(t,e,a){"use strict";var r=a(18),s=a.n(r),i=a(108),o=a.n(i);e.a={data:function(){return{TABLE_CONFIG:{field:{id:"id"},api:{query:"",delete:""}},filter:{pageNum:1,pageSize:15,sort:""},autoLoad:!0,loading:!0,listData:[],totalCount:0,pickedId:[],usePage:!0,useRouterQuery:!1}},beforeRouteUpdate:function(t,e,a){if(this.useRouterQuery){var r=t.query.page||1;this.filter.pageNum=parseInt(r),this.fetchData(),a()}else a()},methods:{fetchData:function(t,e){var a=this;this.TABLE_CONFIG.api.query&&(!t&&this.loading||(this.beforeFetch&&this.beforeFetch(),e=s()({},this.filter,e),this.loading=!0,this.$api(this.TABLE_CONFIG.api.query,e,{showLoading:!0}).then(function(t){a.loading=!1,a.filter=e,a.parseData(t.result),a.afterFetch&&a.afterFetch()}).catch(function(t){a.loading=!1,a._showErrMsg(t)})))},parseData:function(t){this.usePage?(this.listData=t.records,this.totalCount=t.total):(this.listData=t,this.totalCount=t.length)},deleteData:function(t,e){if(this.TABLE_CONFIG.api.delete){var a=this,r=[],i="确定删除该条数据么?";if(t?r.push(t):(r=a.pickedId,i="确定删除选中的数据么?"),!r.length)return a.$Message.warning("未选择任何数据"),!1;var o=s()({},e);o[a.TABLE_CONFIG.field.id]=r.join(","),a._asyncDialog(i,o)}},_asyncDialog:function(t,e){var a=this;a.$Modal.confirm({title:"警告",content:"<p>".concat(t,"</p>"),loading:!0,onOk:function(){a.$api(a.TABLE_CONFIG.api.delete,e).then(function(t){a.$Modal.remove(),a.$Message.success("删除成功"),a.usePage?a.fetchData():a.__delListData(ids)}).catch(function(t){setTimeout(function(){a.$Modal.remove()},500),a._showErrMsg(t)})}})},__delListData:function(a){var r=this;this.listData.forEach(function(t,e){~a.indexOf(t[r.TABLE_CONFIG.field.id])&&r.listData.splice(e,1)})},selectRow:function(t){var e=this,a=[];t.forEach(function(t){a.push(t[e.TABLE_CONFIG.field.id])}),this.pickedId=a},sortData:function(t){t.order?this.filter.sort="ascending"==t.order?2:1:this.filter.sort="",this.fetchData()},pageChange:function(t){if(this.beforePageChange&&this.beforePageChange(t),this.useRouterQuery){var e=this.$route;if((e.query.page||1)==this.filter.pageNum)return;var a={name:e.name,meta:s()({},e.meta),params:s()({},e.params),query:s()({},e.query)};a.query.page=t,e.name||(a.path=e.path),this.$router.push(a)}else this.fetchData();this.afterPageChange&&this.afterPageChange(t)},pushData:function(t){this.listData.unshift(t),this.listData.splice(this.filter.pageSize),this.totalCount++},updateData:function(r){var i=this,o=-1;this.listData.forEach(function(t,e){var a=t[i.TABLE_CONFIG.field.id];a&&a==r[i.TABLE_CONFIG.field.id]&&(o=e)}),-1!=o&&this.$set(this.listData,o,r)}},created:function(){this.fetchDataHandle=o()(this.fetchData,200);var t=this.$route.query.page;t&&(this.filter.pageNum=parseInt(t)),this.autoLoad&&this.fetchData(!0)}}},370:function(t,e,a){"use strict";var r=a(18),i=a.n(r);e.a={data:function(){return{FORM_CONFIG:{field:{id:"id"},api:{info:"",add:"",edit:""}},id:0,inited:!1,formData:{},rules:{},dialogShow:!1,loading:!1,hasEdited:!1,saving:!1,labelWidth:"7em",unEdit:!1}},computed:{title:function(){return this.id?"编辑":"添加"}},watch:{formData:{handler:function(){this.inited&&(this.hasEdited=!0)},deep:!0}},methods:{show:function(t,e,a){this.id=t||0,this.unEdit=a||!1,this.dialogShow=!0,e?this.setFormData(e):this.id?this.fetchData():this.setFormData(this._defaultFormData)},close:function(t){this.hasEdited,this.closeHandle(),"function"==typeof t&&t()},closeHandle:function(){this.dialogShow=!1,this.resetTimer=setTimeout(this.reset,300)},fetchData:function(){var e=this;if(this.FORM_CONFIG.api.info&&!this.loading){var t={};t[this.FORM_CONFIG.field.id]=this.id,this.loading=!0,this.$api(this.FORM_CONFIG.api.info,t).then(function(t){e.setFormData(t.result),e.loading=!1}).catch(function(t){e.loading=!1,e._showErrMsg(t)})}},setFormData:function(t){var e=this;this.formData=i()(!0,{},t),this.$refs.form.resetFields(),this.onSetFormData&&this.onSetFormData(),this.$nextTick(function(){e.inited=!0})},save:function(){var e=this;this.saving||this.$refs.form.validate(function(t){t&&e.post()})},post:function(){var e=this,a=this.id?"edit":"add",t=this.FORM_CONFIG.api[a];if(t&&(!this.beforeSave||!1!==this.beforeSave())){this.saving=!0;var r=this.parsePostData?this.parsePostData():this.formData;this.$api(t,r).then(function(t){e.$emit(a,t.result),e.saving=!1,e.hasEdited=!1,e.$Message.success("保存成功"),e.close(),e.onSuccess&&e.onSuccess(t)}).catch(function(t){e._showErrMsg(t),e.saving=!1,e.onFail&&e.onFail(t)})}},reset:function(){clearTimeout(this.resetTimer),this.inited=!1,this.hasEdited=!1;var t=this.$refs.form;t&&t.resetFields()}},created:function(){this._defaultFormData=i()(!0,{},this.formData)}}},378:function(t,e,a){},379:function(t,e,a){},380:function(t,e,a){},381:function(t,e,a){},382:function(t,e,a){},383:function(t,e,a){},406:function(t,e,a){"use strict";var r=a(378);a.n(r).a},407:function(t,e,a){"use strict";var r=a(379);a.n(r).a},408:function(t,e,a){"use strict";var r=a(380);a.n(r).a},409:function(t,e,a){"use strict";var r=a(381);a.n(r).a},410:function(t,e,a){"use strict";var r=a(382);a.n(r).a},411:function(t,e,a){"use strict";var r=a(383);a.n(r).a},427:function(t,e,a){"use strict";a.r(e);var r=function(){var a=this,t=a.$createElement,r=a._self._c||t;return r("div",{directives:[{name:"title",rawName:"v-title",value:a.pageTitle,expression:"pageTitle"}],staticClass:"c-m-second-materials ui-box"},[r("bread-crumb",{attrs:{data:a.crumbData}}),a._v(" "),r("search",{staticClass:"ui-search",attrs:{data:a.filter},on:{search:a.fetchData}}),a._v(" "),r("div",{staticClass:"ui-hander"},[a._auth("material-manage-second-add")?r("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:a.showAdd}},[a._v("新增")]):a._e()],1),a._v(" "),r("div",{staticClass:"ui-table-content"},[r("Table",{attrs:{border:"",columns:a.columns,data:a.listData},scopedSlots:a._u([{key:"merchanttype",fn:function(t){var e=t.row;return[a._v("\n\t\t\t\t"+a._s(a._f("merchantType")(e.subMerType))+"\n\t\t\t")]}},{key:"status",fn:function(t){var e=t.row;t.column,t.index;return[r("span",{class:a._f("colorFormatter")(e.status)},[a._v(a._s(a._f("statusFormatter")(e.status)))])]}},{key:"handle",fn:function(t){var e=t.row;t.column,t.index;return[0==e.status&&a._auth("material-manage-second-audit")?r("Button",{attrs:{type:"info",size:"small"},on:{click:function(t){return a.showAudit(e.id,e,!0)}}},[a._v("审核")]):-1!=e.status&&1!=e.status||!a._auth("material-manage-second-detail")?a._e():r("Button",{attrs:{size:"small"},on:{click:function(t){return a.showDetail(e.id,e,!0)}}},[a._v("详情")])]}}])})],1),a._v(" "),r("div",{staticClass:"ui-page"},[r("Page",{attrs:{placement:"top",total:a.totalCount,current:a.filter.pageNum,"page-size":a.filter.pageSize,"show-elevator":"","show-total":""},on:{"on-change":a.pageChange,"update:current":function(t){return a.$set(a.filter,"pageNum",t)}}})],1),a._v(" "),r("dialog-form",{ref:"dialogform",on:{add:a.add,audited:a.fetchData}})],1)};r._withStripped=!0;var i=a(368),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ui-second-grade-search search-bar"},[a("Form",{attrs:{model:e.data,inline:"","label-width":120}},[a("FormItem",{attrs:{prop:"id",label:"进件单号"}},[a("Input",{attrs:{placeholder:"进件单号"},model:{value:e.data.id,callback:function(t){e.$set(e.data,"id",t)},expression:"data.id"}})],1),e._v(" "),a("FormItem",{attrs:{prop:"merchantId",label:"一级商户编码"}},[a("Input",{attrs:{placeholder:"一级商户编码"},model:{value:e.data.merchantId,callback:function(t){e.$set(e.data,"merchantId",t)},expression:"data.merchantId"}})],1),e._v(" "),a("FormItem",{attrs:{prop:"subMerId",label:"二级商户编码"}},[a("Input",{attrs:{placeholder:"二级商户编码"},model:{value:e.data.subMerId,callback:function(t){e.$set(e.data,"subMerId",t)},expression:"data.subMerId"}})],1),e._v(" "),a("FormItem",{attrs:{prop:"subMerName",label:"二级商户名称"}},[a("Input",{attrs:{placeholder:"二级商户名称"},model:{value:e.data.subMerName,callback:function(t){e.$set(e.data,"subMerName",t)},expression:"data.subMerName"}})],1),e._v(" "),a("FormItem",{attrs:{prop:"contactName",label:"法定代表人"}},[a("Input",{attrs:{placeholder:"法定代表人"},model:{value:e.data.contactName,callback:function(t){e.$set(e.data,"contactName",t)},expression:"data.contactName"}})],1),e._v(" "),a("FormItem",{attrs:{prop:"companyName",label:"企业名称"}},[a("Input",{attrs:{placeholder:"企业名称"},model:{value:e.data.companyName,callback:function(t){e.$set(e.data,"companyName",t)},expression:"data.companyName"}})],1),e._v(" "),a("br"),e._v(" "),a("FormItem",[a("Button",{attrs:{icon:"ios-search"},on:{click:e.search}},[e._v("搜索")]),e._v(" "),a("Button",{attrs:{icon:"md-refresh"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1)};o._withStripped=!0;var s={props:{data:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{search:function(){this.$emit("search")},reset:function(){var t=this;t.data.id="",t.data.merchantId="",t.data.subMerId="",t.data.subMerName="",t.data.contactName="",t.data.companyName="",t.search()}}},n=(a(406),a(47)),c=Object(n.a)(s,o,[],!1,null,null,null);c.options.__file="src/components/manage/materials/second-grade/search.vue";var l=c.exports,u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ui-materials-second-form"},[a("Modal",{staticClass:"ui-form",attrs:{"mask-closable":!1,title:e.title,width:"600"},on:{"on-cancel":e.closeDefind},model:{value:e.dialogShow,callback:function(t){e.dialogShow=t},expression:"dialogShow"}},[a("Steps",{staticClass:"ui-steps",attrs:{current:e.current,size:"small"}},[a("Step",{attrs:{title:"基础信息"}}),e._v(" "),a("Step",{attrs:{title:"结算信息"}}),e._v(" "),a("Step",{attrs:{title:"附件"}})],1),e._v(" "),a("Form",{ref:"form",attrs:{model:e.formData,"label-width":130}},[a("base-info",{directives:[{name:"show",rawName:"v-show",value:0==e.current,expression:"current==0"}],attrs:{data:e.formData,unedit:e.unEdit}}),e._v(" "),a("check-info",{directives:[{name:"show",rawName:"v-show",value:1==e.current,expression:"current==1"}],attrs:{data:e.formData,unedit:e.unEdit}}),e._v(" "),a("append-info",{directives:[{name:"show",rawName:"v-show",value:2==e.current,expression:"current==2"}],attrs:{data:e.formData,unedit:e.unEdit}})],1),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:e.closeDefind}},[e._v("取消")]),e._v(" "),e.showPrev?a("Button",{on:{click:e.prev}},[a("Icon",{attrs:{type:"ios-skip-backward"}}),e._v(" 上一步")],1):e._e(),e._v(" "),e.showNext?a("Button",{attrs:{type:"primary"},on:{click:e.next}},[e._v("下一步 "),a("Icon",{attrs:{type:"ios-skip-forward"}})],1):e._e(),e._v(" "),e.showSaveBtn?a("Button",{attrs:{type:"primary",disabled:e.loading||e.saving,loading:e.saving},on:{click:e.save}},[e._v("保存")]):e._e(),e._v(" "),e.showAuditBtn?a("Button",{attrs:{type:"success",loading:e.passLoading},on:{click:e.pass}},[a("Icon",{attrs:{type:"ios-checkmark-circle-outline"}}),e._v(" 通过")],1):e._e(),e._v(" "),e.showAuditBtn?a("Button",{attrs:{type:"error",loading:e.refuseLoading},on:{click:e.refuse}},[a("Icon",{attrs:{type:"ios-close-circle-outline"}}),e._v(" 拒绝")],1):e._e()],1)],1)],1)},d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ui-materials-form-base-info"},[a("FormItem",{attrs:{label:"选择一级商户",prop:"merchantId",rules:e.rules.merchantId}},[a("Select",{attrs:{disabled:e.unedit,placeholder:"选择一级商户"},model:{value:e.data.merchantId,callback:function(t){e.$set(e.data,"merchantId",t)},expression:"data.merchantId"}},e._l(e.merchantOption,function(t){return a("Option",{key:t.merchantId,attrs:{value:t.merchantId}},[e._v(e._s(t.merchantName))])}),1)],1),e._v(" "),a("FormItem",{attrs:{label:"二级商户名称",prop:"subMerName",rules:e.rules.subMerName}},[a("Input",{attrs:{readonly:e.unedit,placeholder:"商户名称"},model:{value:e.data.subMerName,callback:function(t){e.$set(e.data,"subMerName",t)},expression:"data.subMerName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"二级商户类型",prop:"subMerType",rules:e.rules.subMerType}},[a("Select",{attrs:{disabled:e.unedit,placeholder:"二级商户类型"},model:{value:e.data.subMerType,callback:function(t){e.$set(e.data,"subMerType",t)},expression:"data.subMerType"}},e._l(e.subMerTypeOption,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1)],1),e._v(" "),a("FormItem",{attrs:{label:"法定代表人",prop:"contactName",rules:e.rules.contactName}},[a("Input",{attrs:{readonly:e.unedit,placeholder:"法定代表人"},model:{value:e.data.contactName,callback:function(t){e.$set(e.data,"contactName",t)},expression:"data.contactName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"法定代表人证件类型",prop:"certificateType",rules:e.rules.certificateType}},[a("Select",{attrs:{disabled:e.unedit,placeholder:"法定代表人证件类型"},model:{value:e.data.certificateType,callback:function(t){e.$set(e.data,"certificateType",t)},expression:"data.certificateType"}},e._l(e.certificateTypeOption,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1)],1),e._v(" "),a("FormItem",{attrs:{label:"法定代表人证件编号",prop:"certificateNo",rules:e.rules.certificateNo}},[a("Input",{attrs:{readonly:e.unedit,placeholder:"法定代表人证件编号"},model:{value:e.data.certificateNo,callback:function(t){e.$set(e.data,"certificateNo",t)},expression:"data.certificateNo"}})],1),e._v(" "),a("FormItem",{attrs:{label:"企业名称",prop:"companyName",rules:e.rules.companyName}},[a("Input",{attrs:{readonly:e.unedit,placeholder:"企业名称"},model:{value:e.data.companyName,callback:function(t){e.$set(e.data,"companyName",t)},expression:"data.companyName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"企业证件类型",prop:"companyCertType",rules:e.rules.companyCertType}},[a("Select",{attrs:{disabled:e.unedit,placeholder:"企业证件类型"},model:{value:e.data.companyCertType,callback:function(t){e.$set(e.data,"companyCertType",t)},expression:"data.companyCertType"}},e._l(e.companyCertTypeOption,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1)],1),e._v(" "),a("FormItem",{attrs:{label:"企业证件编号",prop:"companyCertNo",rules:e.rules.companyCertNo}},[a("Input",{attrs:{readonly:e.unedit,placeholder:"企业证件编号"},model:{value:e.data.companyCertNo,callback:function(t){e.$set(e.data,"companyCertNo",t)},expression:"data.companyCertNo"}})],1)],1)};d._withStripped=u._withStripped=!0;var h={props:{data:{type:Object,default:function(){return{}}},unedit:{type:Boolean,default:function(){return!1}}},data:function(){return{merchantOption:[],subMerTypeOption:[{label:"个人商户",value:"1"},{label:"企业商户",value:"2"}],certificateTypeOption:[{label:"身份证",value:"I"},{label:"护照",value:"P"},{label:"军官证",value:"G"},{label:"其他证件",value:"U"}],companyCertTypeOption:[{label:"营业执照",value:"U"},{label:"组织机构代码",value:"Y"},{label:"统一社会信用代码",value:"V"}],rules:{merchantId:[{required:!0,message:"请选择一级商户",trigger:"change"}],subMerName:[{required:!0,message:"请填写二级商户名称",trigger:"blur"}],subMerType:[{required:!0,message:"请选择二级商户类型",trigger:"change"}],contactName:[{required:!0,message:"请填写法定代表人",trigger:"blur"}],certificateType:[{required:!0,message:"请选择法定代表人证件类型",trigger:"change"}],certificateNo:[{required:!0,message:"请填写法定代表人证件编号",trigger:"blur"},{validator:this.checkIdNumber,trigger:"blur"}],companyName:[{required:!0,message:"请填写企业名称",trigger:"blur"}],companyCertType:[{required:!0,message:"请选择企业证件类型",trigger:"change"}],companyCertNo:[{required:!0,message:"请填写企业证件编号",trigger:"blur"}]}}},methods:{checkIdNumber:function(t,e,a){var r=this.data.certificateType,i=this.$cfg.REG.idNumber;if("I"==r&&e&&!i.test(e))return a(new Error("请输入正确的身份证号"));a()},fetchFirstMerchant:function(){var e=this;e.merchantOption.length||e.$api(e.$cfg.API.merchant.first.query,{pageNum:1,pageSize:1e3}).then(function(t){e.merchantOption=t.result.records||[]}).catch(function(){})}},created:function(){this.$bus.on("fetchFirstMerchant",this.fetchFirstMerchant)},beforeDestroy:function(){this.$bus.off("fetchFirstMerchant",this.fetchFirstMerchant)}},p=(a(407),Object(n.a)(h,d,[],!1,null,null,null));p.options.__file="src/components/manage/materials/second-grade/base-info.vue";var m=p.exports,f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ui-materials-form-check-info"},[a("FormItem",{attrs:{label:"收款账户名",prop:"accountName",rules:e.rules.accountName}},[a("Input",{attrs:{readonly:e.unedit,placeholder:"收款账户名"},model:{value:e.data.accountName,callback:function(t){e.$set(e.data,"accountName",t)},expression:"data.accountName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"收款银行",prop:"bankName",rules:e.rules.bankName}},[a("Input",{attrs:{readonly:e.unedit,placeholder:"收款银行"},model:{value:e.data.bankName,callback:function(t){e.$set(e.data,"bankName",t)},expression:"data.bankName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"收款账号",prop:"account",rules:e.rules.account}},[a("Input",{attrs:{readonly:e.unedit,placeholder:"收款账号"},model:{value:e.data.account,callback:function(t){e.$set(e.data,"account",t)},expression:"data.account"}})],1),e._v(" "),a("FormItem",{attrs:{label:"收款账户类型",prop:"accountType",rules:e.rules.accountType}},[a("Select",{attrs:{disabled:e.unedit,placeholder:"收款账户类型"},model:{value:e.data.accountType,callback:function(t){e.$set(e.data,"accountType",t)},expression:"data.accountType"}},e._l(e.accountTypeOption,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1)],1),e._v(" "),a("FormItem",{attrs:{label:"银行预留手机号",prop:"mobilePhone",rules:e.rules.mobilePhone}},[a("Input",{attrs:{readonly:e.unedit,placeholder:"银行预留手机号"},model:{value:e.data.mobilePhone,callback:function(t){e.$set(e.data,"mobilePhone",t)},expression:"data.mobilePhone"}})],1),e._v(" "),a("FormItem",{attrs:{label:"地址",prop:"address"}},[a("Input",{attrs:{readonly:e.unedit,placeholder:"地址"},model:{value:e.data.address,callback:function(t){e.$set(e.data,"address",t)},expression:"data.address"}})],1),e._v(" "),a("FormItem",{attrs:{label:"备注",prop:"remark"}},[a("Input",{attrs:{readonly:e.unedit,type:"textarea",placeholder:"备注"},model:{value:e.data.remark,callback:function(t){e.$set(e.data,"remark",t)},expression:"data.remark"}})],1)],1)};f._withStripped=!0;var v={props:{data:{type:Object,default:function(){return{}}},unedit:{type:Boolean,default:function(){return!1}}},data:function(){return{accountTypeOption:[{label:"借记卡",value:"401"},{label:"支票户",value:"601"}],rules:{accountName:[{required:!0,message:"请填写收款账户名",trigger:"blur"}],bankName:[{required:!0,message:"请填写收款银行",trigger:"blur"}],account:[{required:!0,message:"请填写收款账号",trigger:"blur"}],accountType:[{required:!0,message:"请选择收款账户类型",trigger:"change"}],mobilePhone:[{required:!0,message:"请填写银行预留手机号",trigger:"blur"},{validator:this.checkPhone,trigger:"blur"}]}}},methods:{checkPhone:function(t,e,a){var r=this.$cfg.REG.phone;if(e&&!r.test(e))return a(new Error("请输入正确的手机号"));a()}}},g=(a(408),Object(n.a)(v,f,[],!1,null,null,null));g.options.__file="src/components/manage/materials/second-grade/check-info.vue";var b=g.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ui-materials-form-append-info"},[a("FormItem",{attrs:{label:"身份证正面照",prop:"idCardFontPhoto",rules:e.rules.idCardFontPhoto,"label-width":170}},[a("div",{staticClass:"img-upload-box"},[a("img",{attrs:{src:e._f("urlCompletion")(e.data.idCardFontPhoto),alt:" "}}),e._v(" "),a("div",{staticClass:"icon-box"},[a("a",{directives:[{name:"show",rawName:"v-show",value:e.data.idCardFontPhoto,expression:"data.idCardFontPhoto"}],attrs:{href:e._f("urlCompletion")(e.data.idCardFontPhoto),target:"_blank"}},[a("Icon",{staticClass:"icon-eye",attrs:{type:"ios-eye"}})],1),e._v(" "),e.unedit?e._e():a("Icon",{staticClass:"icon-camera",attrs:{type:"ios-camera"},on:{click:function(t){return e.showUpload("idCardFontPhoto")}}})],1)])]),e._v(" "),a("FormItem",{attrs:{label:"身份证反面照",prop:"idCardBackPhoto",rules:e.rules.idCardBackPhoto,"label-width":170}},[a("div",{staticClass:"img-upload-box"},[a("img",{attrs:{src:e._f("urlCompletion")(e.data.idCardBackPhoto),alt:" "}}),e._v(" "),a("div",{staticClass:"icon-box"},[a("a",{directives:[{name:"show",rawName:"v-show",value:e.data.idCardBackPhoto,expression:"data.idCardBackPhoto"}],attrs:{href:e._f("urlCompletion")(e.data.idCardBackPhoto),target:"_blank"}},[a("Icon",{staticClass:"icon-eye",attrs:{type:"ios-eye"}})],1),e._v(" "),e.unedit?e._e():a("Icon",{staticClass:"icon-camera",attrs:{type:"ios-camera"},on:{click:function(t){return e.showUpload("idCardBackPhoto")}}})],1)])]),e._v(" "),a("FormItem",{attrs:{label:"营业执照",prop:"businessLicensePhoto",rules:e.rules.businessLicensePhoto,"label-width":170}},[a("div",{staticClass:"img-upload-box"},[a("img",{attrs:{src:e._f("urlCompletion")(e.data.businessLicensePhoto),alt:" "}}),e._v(" "),a("div",{staticClass:"icon-box"},[a("a",{directives:[{name:"show",rawName:"v-show",value:e.data.businessLicensePhoto,expression:"data.businessLicensePhoto"}],attrs:{href:e._f("urlCompletion")(e.data.businessLicensePhoto),target:"_blank"}},[a("Icon",{staticClass:"icon-eye",attrs:{type:"ios-eye"}})],1),e._v(" "),e.unedit?e._e():a("Icon",{staticClass:"icon-camera",attrs:{type:"ios-camera"},on:{click:function(t){return e.showUpload("businessLicensePhoto")}}})],1)])]),e._v(" "),a("FormItem",{attrs:{label:"门头照",prop:"stroePtoto",rules:e.rules.stroePtoto,"label-width":170}},[a("div",{staticClass:"img-upload-box"},[a("img",{attrs:{src:e._f("urlCompletion")(e.data.stroePtoto),alt:" "}}),e._v(" "),a("div",{staticClass:"icon-box"},[a("a",{directives:[{name:"show",rawName:"v-show",value:e.data.stroePtoto,expression:"data.stroePtoto"}],attrs:{href:e._f("urlCompletion")(e.data.stroePtoto),target:"_blank"}},[a("Icon",{staticClass:"icon-eye",attrs:{type:"ios-eye"}})],1),e._v(" "),e.unedit?e._e():a("Icon",{staticClass:"icon-camera",attrs:{type:"ios-camera"},on:{click:function(t){return e.showUpload("stroePtoto")}}})],1)])]),e._v(" "),a("FormItem",{attrs:{label:"客户经理与门店负责人合照",prop:"groupPhoto",rules:e.rules.groupPhoto,"label-width":170}},[a("div",{staticClass:"img-upload-box"},[a("img",{attrs:{src:e._f("urlCompletion")(e.data.groupPhoto),alt:" "}}),e._v(" "),a("div",{staticClass:"icon-box"},[a("a",{directives:[{name:"show",rawName:"v-show",value:e.data.groupPhoto,expression:"data.groupPhoto"}],attrs:{href:e._f("urlCompletion")(e.data.groupPhoto),target:"_blank"}},[a("Icon",{staticClass:"icon-eye",attrs:{type:"ios-eye"}})],1),e._v(" "),e.unedit?e._e():a("Icon",{staticClass:"icon-camera",attrs:{type:"ios-camera"},on:{click:function(t){return e.showUpload("groupPhoto")}}})],1)])]),e._v(" "),a("img-upload",{ref:"imgupload",attrs:{option:e.uploadOption},on:{done:e.done}})],1)},y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Modal",{staticClass:"ui-upload-model ui-form",attrs:{"mask-closable":!1,title:e.title,width:"600"},on:{"on-cancel":e.hide},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("Upload",{ref:"upload",attrs:{multiple:e.options.multiple,type:"drag",format:e.options.format,"max-size":e.options.maxSize,"before-upload":e.handleBeforeUpload,"on-exceeded-size":e.handleMaxSize,"on-format-error":e.handleFormatError,"on-error":e.handleError,"on-progress":e.handleProgress,"on-success":e.handleSuccess,action:e.options.urlPath||"",name:e.options.name}},[a("div",{ref:"pickup",staticClass:"area"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.preview,expression:"!preview"}],staticClass:"shade"},[a("Icon",{attrs:{type:"ios-cloud-upload",size:"52"}}),e._v(" "),a("p",[e._v("点击或将图片拖拽到这里进行上传")]),e._v(" "),a("p",{staticClass:"tip"},[e._v("("+e._s(e.options.tip)+")")])],1)])]),e._v(" "),e.chooseFile?a("p",[e._v("已选择文件："),a("span",{staticClass:"choosed"},[e._v(e._s(e.chooseFile))])]):e._e(),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:e.hide}},[e._v("取消")]),e._v(" "),a("Button",{attrs:{type:"primary",loading:e.loadingStatus},on:{click:e.uploadFile}},[e._v("上传")])],1)],1)],1)};y._withStripped=_._withStripped=!0;var I=a(18),w=a.n(I),N=(a(33),a(54)),C={multiple:!1,maxSize:10240,format:[],name:"file",urlPath:"/fileupload/common/upload!uploadFile.action",tip:"请上传文件,大小不超过10M"},F={props:{option:{type:Object,default:function(){return{}}},url:{type:String,default:""}},data:function(){return{loadingStatus:!1,title:"图片上传",visible:!1,preview:!1,options:{},readyFiles:[]}},computed:{chooseFile:function(){return this.readyFiles.map(function(t){return t.name}).join(",")}},methods:{show:function(){this.visible=!0,this.options=w()({},C,this.option)},hide:function(){this.visible=!1,this.reset()},handleBeforeUpload:function(t){return this.readyFiles.push(t),!1},handleFormatError:function(t,e){var a="文件 ".concat(t.name," 的格式错误");this.$Message.error(a),this.reset()},handleMaxSize:function(t,e){var a=Object(N.a)(1024*this.options.maxSize," "),r="文件 ".concat(t.name," 大小超过").concat(a);this.$Message.error(r),this.reset()},handleError:function(t,e,a){this._showErrMsg("","上传出错"),this.loadingStatus=!1},handleProgress:function(t,e,a){},handleSuccess:function(t,e,a){0==t.error?(this.$emit("done",t.url),this.hide(),this.$Message.success("上传成功")):(this.reset(),this.$Message.error("上传失败,重新选择文件"))},uploadFile:function(){this.readyFiles;if(this.readyFiles.length){this.loadingStatus=!0;for(var t=0;t<this.readyFiles.length;t++){var e=this.readyFiles[t];this.$refs.upload.post(e)}}else this.$Message.warning("请选择文件")},reset:function(){this.loadingStatus=!1,this.readyFiles=[],this.preview=!1,this.$refs.upload.clearFiles()}}},k=(a(409),Object(n.a)(F,y,[],!1,null,null,null));k.options.__file="src/components/manage/common/img-upload.vue";var P=k.exports,$={props:{data:{type:Object,default:function(){return{}}},unedit:{type:Boolean,default:function(){return!1}}},components:{imgUpload:P},data:function(){return{uploadOption:{maxSize:5120,format:this.$cfg.FILE.image,name:"uploadify",tip:"请上传 jpg,jpeg,gif,png 格式的图片文件,大小不超过5M"},curElement:"",rules:{idCardFontPhoto:[{required:!0,message:"请上传身份证正面照",trigger:"blur"}],idCardBackPhoto:[{required:!0,message:"请上传身份证反面照",trigger:"blur"}],businessLicensePhoto:[{required:!0,message:"请上传营业执照",trigger:"blur"}],stroePtoto:[{required:!0,message:"请上传门头照",trigger:"blur"}],groupPhoto:[{required:!0,message:"请上传客户经理与门店负责人合照",trigger:"blur"}]}}},filters:{urlCompletion:function(t){return t?window.location.protocol+"//"+window.location.host+"/fileupload/"+t:""}},methods:{showUpload:function(t){this.curElement=t,this.$refs.imgupload.show()},done:function(t){var e=this.curElement;this.data[e]=t}}},M=(a(410),Object(n.a)($,_,[],!1,null,null,null));M.options.__file="src/components/manage/materials/second-grade/append-info.vue";var x=M.exports,T={mixins:[a(370).a],components:{baseInfo:m,checkInfo:b,appendInfo:x},data:function(){return{current:0,passLoading:!1,refuseLoading:!1,isAuditMode:!1,FORM_CONFIG:{field:{id:"id"},api:{add:this.$cfg.API.materials.add}},formData:{merchantId:"",subMerName:"",subMerType:"",contactName:"",certificateType:"",certificateNo:"",companyName:"",companyCertType:"",companyCertNo:"",accountName:"",account:"",bankName:"",accountType:"",mobilePhone:"",address:"",remark:"",idCardFontPhoto:"",idCardBackPhoto:"",businessLicensePhoto:"",stroePtoto:"",groupPhoto:""}}},computed:{showSaveBtn:function(){return 2==this.current&&!this.isAuditMode&&!this.unEdit},showAuditBtn:function(){return!(2!=this.current||!this.isAuditMode)},showPrev:function(){return 0<this.current},showNext:function(){return this.current<2}},methods:{prev:function(){this.current-=1},next:function(t){var e=this,a=[];[["merchantId","subMerName","subMerType","contactName","certificateType","certificateNo","companyName","companyCertType","companyCertNo"],["accountName","account","bankName","accountType","mobilePhone"],["idCardFontPhoto","idCardBackPhoto","businessLicensePhoto","stroePtoto","groupPhoto"]][e.current].forEach(function(t){e.$refs.form.validateField(t,function(t){t&&a.push(t)})}),a.length||(e.current+=1)},closeDefind:function(){this.unAuditMode(),this.close(this.firstPage)},firstPage:function(){this.current=0},auditMode:function(){this.isAuditMode=!0},unAuditMode:function(){this.isAuditMode=!1},pass:function(){this.auditHandle(1)},refuse:function(){this.auditHandle(-1)},auditHandle:function(e){var a=this,t=w()(!0,{},this.formData);t.status=e,this.loadingHandle(e,!0),this.$api(this.$cfg.API.materials.audit,t).then(function(t){a.$Message.success("审核操作成功"),a.loadingHandle(e,!1),a.closeDefind(),a.$emit("audited")}).catch(function(t){a.loadingHandle(e,!1),a._showErrMsg(t,"审核操作失败")})},loadingHandle:function(t,e){1==t?this.passLoading=e:-1==t&&(this.refuseLoading=e)}}},D=Object(n.a)(T,u,[],!1,null,null,null);D.options.__file="src/components/manage/materials/second-grade/form.vue";var O=D.exports,E={mixins:[a(369).a],components:{Search:l,DialogForm:O,BreadCrumb:i.a},data:function(){return{pageTitle:"二级商户进件",crumbData:["进件管理","二级商户进件"],filter:{id:"",merchantId:"",subMerId:"",subMerName:"",contactName:"",companyName:""},TABLE_CONFIG:{field:{id:"id"},api:{query:this.$cfg.API.materials.query}},columns:[{title:"序号",type:"index",width:50,align:"center"},{title:"进件单号",key:"id",align:"center"},{title:"一级商户编号",key:"merchantId",align:"center"},{title:"二级商户编号",key:"subMerId",align:"center"},{title:"二级商户名称",key:"subMerName",align:"center"},{title:"二级商户类型",key:"subMerType",width:100,align:"center",slot:"merchanttype"},{title:"法定代表人",key:"contactName",width:100,align:"center"},{title:"企业名称",key:"companyName",align:"center"},{title:"流程状态",key:"status",width:100,align:"center",slot:"status"},{title:"操作",align:"center",width:120,slot:"handle"}]}},filters:{statusFormatter:function(t){return 0==t?"待审核":-1==t?"已拒绝":1==t?"已批准":void 0},colorFormatter:function(t){return 0==t?"blue":-1==t?"error":1==t?"green":void 0},merchantType:function(t){return 1==t?"个人商户":"企业商户"}},methods:{showAdd:function(){this.$refs.dialogform.show(),this.$bus.emit("fetchFirstMerchant")},showAudit:function(t,e,a){this.$refs.dialogform.auditMode(),this.$refs.dialogform.show(t,e,a),this.$bus.emit("fetchFirstMerchant")},showDetail:function(t,e,a){this.$refs.dialogform.show(t,e,a),this.$bus.emit("fetchFirstMerchant")},add:function(t){this.$refs.dialogform.firstPage(),this.fetchData()}}},S=(a(411),Object(n.a)(E,r,[],!1,null,null,null));S.options.__file="src/components/manage/materials/second-grade/index.vue";e.default=S.exports}}]);