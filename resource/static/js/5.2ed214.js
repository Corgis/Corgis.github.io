(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{406:function(t,e,a){t.exports=a(47)(105)},408:function(t,e,a){},409:function(t,e,a){"use strict";var i=a(13),s=a.n(i),n=a(76),l=a.n(n);e.a={data:function(){return{TABLE_CONFIG:{field:{id:"id"},api:{query:"",delete:""}},filter:{currPage:1,pageSize:15,sort:""},autoLoad:!0,loading:!0,listData:[],totalCount:0,pickedId:[],usePage:!0,useRouterQuery:!1}},beforeRouteUpdate:function(t,e,a){if(this.useRouterQuery){var i=t.query.page||1;this.filter.currPage=parseInt(i),this.fetchData(),a()}else a()},methods:{fetchData:function(t,e){var a=this;this.TABLE_CONFIG.api.query&&(!t&&this.loading||(this.beforeFetch&&this.beforeFetch(),e=s()({},this.filter,e),this.loading=!0,this.$api(this.TABLE_CONFIG.api.query,e,{showLoading:!0}).then(function(t){a.loading=!1,a.filter=e,a.parseData(t.object),a.afterFetch&&a.afterFetch(t.object)}).catch(function(t){a.loading=!1,a._showErrMsg(t)})))},parseData:function(t){this.usePage?(this.listData=t.records,this.totalCount=t.total):(this.listData=t,this.totalCount=t.length)},deleteData:function(t,e){if(this.TABLE_CONFIG.api.delete){var a=this,i=[],n="确定删除该条数据么?";if(t?i.push(t):(i=a.pickedId,n="确定删除选中的数据么?"),!i.length)return a.$message.warning("未选择任何数据"),!1;var l=s()({},e);l[a.TABLE_CONFIG.field.id]=i.join(","),a._asyncDialog(n,"警告",{confirmButtonText:"删除",type:"warning",confirmButtonClass:"el-button--danger",api:a.TABLE_CONFIG.api.delete,params:l,success:function(){a.$message({message:"删除成功",type:"success"}),a.usePage?a.fetchData():a.__delListData(i)}})}},__delListData:function(a){var i=this;this.listData.forEach(function(t,e){~a.indexOf(t[i.TABLE_CONFIG.field.id])&&i.listData.splice(e,1)})},selectRow:function(t){var e=this,a=[];t.forEach(function(t){a.push(t[e.TABLE_CONFIG.field.id])}),this.pickedId=a},sortData:function(t){t.order?this.filter.sort="ascending"==t.order?2:1:this.filter.sort="",this.fetchData()},pageChange:function(t){if(this.beforePageChange&&this.beforePageChange(t),this.useRouterQuery){var e=this.$route;if((e.query.page||1)==this.filter.currPage)return;var a={name:e.name,meta:s()({},e.meta),params:s()({},e.params),query:s()({},e.query)};a.query.page=t,e.name||(a.path=e.path),this.$router.push(a)}else this.fetchData();this.afterPageChange&&this.afterPageChange(t)},pushData:function(t){this.listData.unshift(t),this.listData.splice(this.filter.pageSize),this.totalCount++},updateData:function(i){var n=this,l=-1;this.listData.forEach(function(t,e){var a=t[n.TABLE_CONFIG.field.id];a&&a==i[n.TABLE_CONFIG.field.id]&&(l=e)}),-1!=l&&this.$set(this.listData,l,i)},filterChangeHandle:function(){this.beforeFilterChangeHandle&&this.beforeFilterChangeHandle(),this.fetchDataHandle(!1,{currPage:1})}},created:function(){this.fetchDataHandle=l()(this.fetchData,200);var t=this.$route.query.page;t&&(this.filter.currPage=parseInt(t)),this.autoLoad&&this.fetchData(!0)}}},410:function(t,e,a){"use strict";var i=a(408);a.n(i).a},411:function(t,e,a){"use strict";var i=a(13),n=a.n(i);e.a={data:function(){return{FORM_CONFIG:{field:{id:"id"},api:{info:"",add:"",edit:""}},id:0,inited:!1,formData:{},rules:{},dialogShow:!1,loading:!1,hasEdited:!1,saving:!1,labelWidth:"7em",unEdit:!1}},computed:{title:function(){return this.id?"编辑":"添加"}},watch:{formData:{handler:function(){this.inited&&(this.hasEdited=!0)},deep:!0}},methods:{show:function(t,e,a){this.id=t||0,this.unEdit=a||!1,this.dialogShow=!0,e?this.setFormData(e):this.id?this.fetchData():this.setFormData(this._defaultFormData)},close:function(t){var e=this;this.hasEdited?this.$confirm("表单未保存，确定要关闭吗？","警告",{confirmButtonText:"关闭",cancelButtonText:"点错了",type:"warning"}).then(function(){e.closeHandle(),"function"==typeof t&&t()}).catch(function(){}):(this.closeHandle(),"function"==typeof t&&t())},closeHandle:function(){this.dialogShow=!1,this.resetTimer=setTimeout(this.reset,300)},fetchData:function(){var e=this;if(this.FORM_CONFIG.api.info&&!this.loading){var t={};t[this.FORM_CONFIG.field.id]=this.id,this.loading=!0,this.$api(this.FORM_CONFIG.api.info,t).then(function(t){e.setFormData(t.object),e.loading=!1}).catch(function(t){e.loading=!1,e._showErrMsg(t)})}},setFormData:function(t){var e=this;this.formData=n()(!0,{},t),this.onSetFormData&&this.onSetFormData(),this.$nextTick(function(){e.inited=!0,e.$refs.form.clearValidate()})},save:function(){var e=this;this.saving||this.$refs.form.validate(function(t){t&&e.post()})},post:function(){var e=this,a=this.id?"edit":"add",t=this.FORM_CONFIG.api[a];if(t&&(!this.beforeSave||!1!==this.beforeSave())){this.saving=!0;var i=this.parsePostData?this.parsePostData():this.formData;this.$api(t,i).then(function(t){e.$emit(a,t.object),e.saving=!1,e.hasEdited=!1,e.$message.success("保存成功"),e.close(),e.onSuccess&&e.onSuccess(t)}).catch(function(t){e._showErrMsg(t),e.saving=!1,e.onFail&&e.onFail(t)})}},reset:function(){clearTimeout(this.resetTimer),this.inited=!1,this.hasEdited=!1;var t=this.$refs.form;t&&t.resetFields()}},created:function(){this._defaultFormData=n()(!0,{},this.formData)}}},412:function(t,e,a){"use strict";var i=function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{staticClass:"ui-bread-crumb"},[i("el-breadcrumb",a._l(a.data,function(t,e){return i("el-breadcrumb-item",{key:e},[a._v(a._s(t))])}),1)],1)};i._withStripped=!0;var n={props:{data:{type:Array,default:function(){return[]}}}},l=(a(410),a(46)),s=Object(l.a)(n,i,[],!1,null,null,null);s.options.__file="src/components/manage/common/bread-crumb.vue";e.a=s.exports},435:function(t,e,a){},436:function(t,e,a){},437:function(t,e,a){},438:function(t,e,a){},461:function(t,e,a){"use strict";var i=a(435);a.n(i).a},462:function(t,e,a){"use strict";var i=a(436);a.n(i).a},463:function(t,e,a){"use strict";var i=a(437);a.n(i).a},464:function(t,e,a){"use strict";var i=a(438);a.n(i).a},466:function(t,e,a){"use strict";a.r(e);var i=function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{directives:[{name:"title",rawName:"v-title",value:a.pageTitle,expression:"pageTitle"}],staticClass:"c-m-teminal-list ui-box"},[i("bread-crumb",{attrs:{data:a.crumbData}}),a._v(" "),i("search",{staticClass:"ui-search",attrs:{data:a.filter},on:{filterchange:a.filterChangeHandle}},[i("el-button",{staticClass:"ui-skin-btn ui-front-btn",attrs:{slot:"addbtn",type:"primary",icon:"iconfont icon-add",size:"medium"},on:{click:a.showAdd},slot:"addbtn"},[a._v("新增")])],1),a._v(" "),i("div",{staticClass:"ui-table-content"},[i("el-table",{attrs:{data:a.listData,border:"",stripe:""}},[i("el-table-column",{attrs:{prop:"terminalNO",label:"SN号","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"model",label:"型号","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{label:"状态","header-align":"center",align:"center"},scopedSlots:a._u([{key:"default",fn:function(t){return[0==t.row.online?i("el-button",{attrs:{disabled:"",size:"mini"}},[a._v("离线")]):1==t.row.online?i("el-button",{attrs:{type:"success",plain:"",size:"mini"}},[a._v("在线")]):a._e()]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"organizationName",label:"所属机构","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"lastConnectionTime",label:"最新在线时间","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{label:"操作","min-width":"130px"},scopedSlots:a._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return a.showDetailDialog(e.row)}}},[a._v("详情")]),a._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return a.showAppList(e.row)}}},[a._v("应用")]),a._v(" "),i("el-dropdown",{attrs:{placement:"bottom-start"},on:{command:a.menuCommandHandle}},[i("el-link",{attrs:{type:"primary"}},[a._v("\n\t\t\t\t\t\t\t更多"),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:["showEdit",e.row]}},[a._v("编辑")]),a._v(" "),i("el-dropdown-item",{attrs:{command:["showLogTable",e.row]}},[a._v("日志列表")])],1)],1)]}}])})],1)],1),a._v(" "),i("div",{staticClass:"ui-page"},[i("el-pagination",{attrs:{"page-size":a.filter.pageSize,"current-page":a.filter.currPage,layout:"total, prev, pager, next, jumper",total:a.totalCount},on:{"current-change":a.pageChange,"update:currentPage":function(t){return a.$set(a.filter,"currPage",t)},"update:current-page":function(t){return a.$set(a.filter,"currPage",t)}}})],1),a._v(" "),i("terminal-dialog",{ref:"terminaldialog",on:{add:a.fetchData,edit:a.fetchData}}),a._v(" "),i("terminal-detail",{ref:"terminaldetail"}),a._v(" "),i("app-list-dialog",{ref:"applistdialog"}),a._v(" "),i("log-list-dialog",{ref:"terminalloglist"})],1)};i._withStripped=!0;var n=a(412),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"c-m-market-search search-bar"},[a("el-row",{attrs:{gutter:15}},[e._t("addbtn"),e._v(" "),a("el-col",{attrs:{xs:8,sm:5,lg:5,xl:3}},[a("el-input",{attrs:{"suffix-icon":"el-icon-search",clearable:"",placeholder:"请输入SN号搜索"},on:{change:e.filterFecth},model:{value:e.data.terminalNO,callback:function(t){e.$set(e.data,"terminalNO",t)},expression:"data.terminalNO"}})],1),e._v(" "),a("el-col",{attrs:{xs:8,sm:5,lg:5,xl:3}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择型号搜索"},on:{change:e.filterFecth},model:{value:e.data.model,callback:function(t){e.$set(e.data,"model",t)},expression:"data.model"}},e._l(e.terminalModelOption,function(t){return a("el-option",{key:t.modelId,attrs:{label:t.modelName,value:t.modelId}})}),1)],1),e._v(" "),a("el-col",{attrs:{xs:8,sm:5,lg:5,xl:3}},[a("treeselect",{attrs:{noResultsText:e.noResultsText,noOptionsText:e.noOptionsText,placeholder:"机构选择",options:e.organizationOption,normalizer:e.normalizer},on:{input:e.filterFecth},model:{value:e.data.organizationNo,callback:function(t){e.$set(e.data,"organizationNo",t)},expression:"data.organizationNo"}})],1)],2)],1)};l._withStripped=!0;var s=a(403),r=a.n(s),o=(a(404),{components:{Treeselect:r.a},props:{data:{type:Object,default:function(){return{}}}},data:function(){return{terminalModelOption:[],noOptionsText:"暂无机构",noResultsText:"无对应搜索结果",normalizer:function(t){return{id:t.id,label:t.organizationName,children:t.children}}}},computed:{organizationOption:function(){return this.$store.state.info.organizationOption}},methods:{filterFecth:function(){this.$emit("filterchange")},fetchTerminalOption:function(){var e=this;e.terminalModelOption&&e.terminalModelOption.length||this.$api(this.$cfg.API.application.model.query,{currPage:1,pageSize:1e3}).then(function(t){e.terminalModelOption=t.object.records}).catch(function(){})}},created:function(){this.fetchTerminalOption()}}),c=a(46),d=Object(c.a)(o,l,[],!1,null,null,null);d.options.__file="src/components/manage/terminal/terminal-list/search.vue";var u=d.exports,f=a(409),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"c-m-terminal-dialog ui-form",attrs:{title:e.title,visible:e.dialogShow,"lock-scroll":!1,"close-on-click-modal":!1,"before-close":e.close,width:"450px"},on:{"update:visible":function(t){e.dialogShow=t}}},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,"label-width":"80px","label-position":"right"}},[a("el-form-item",{attrs:{label:"SN号",prop:"terminalNO"}},[a("el-input",{attrs:{placeholder:"请输入SN号"},model:{value:e.formData.terminalNO,callback:function(t){e.$set(e.formData,"terminalNO",t)},expression:"formData.terminalNO"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"型号",prop:"model"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择型号"},model:{value:e.formData.model,callback:function(t){e.$set(e.formData,"model",t)},expression:"formData.model"}},e._l(e.terminalModelOption,function(t){return a("el-option",{key:t.modelId,attrs:{label:t.modelName,value:t.modelId}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"机构选择",prop:"organizationNo"}},[a("treeselect",{attrs:{placeholder:"机构选择",noResultsText:e.noResultsText,noOptionsText:e.noOptionsText,multiple:!0,options:e.organizationOption,normalizer:e.normalizer},model:{value:e.formData.organizationNo,callback:function(t){e.$set(e.formData,"organizationNo",t)},expression:"formData.organizationNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"门店品牌",prop:"merchant"}},[a("el-input",{attrs:{type:"textarea",rows:"4",placeholder:"请按示例输入"},model:{value:e.formData.merchant,callback:function(t){e.$set(e.formData,"merchant",t)},expression:"formData.merchant"}}),e._v(" "),a("el-popover",{attrs:{placement:"right-start",width:"100",trigger:"hover","popper-class":"example-popper"}},[a("div",[a("pre",[e._v(e._s(e.tip))])]),e._v(" "),a("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[e._v("示例")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:e.close}},[e._v("关 闭")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",disabled:e.saving,loading:e.saving},on:{click:e.save}},[e._v("保 存")])],1)],1)};p._withStripped=!0;var h={mixins:[a(411).a],components:{Treeselect:r.a},data:function(){return{FORM_CONFIG:{field:{id:"id"},api:{add:this.$cfg.API.terminal.add,edit:this.$cfg.API.terminal.edit}},formData:{terminalNO:"",model:"",organizationNo:[],merchant:""},terminalModelOption:[],noOptionsText:"暂无机构",noResultsText:"无对应搜索结果",normalizer:function(t){return{id:t.id,label:t.organizationName,children:t.children}},rules:{terminalNO:[{required:!0,message:"请输入SN号",trigger:"blur"}],model:[{required:!0,message:"请选择型号",trigger:"change"}]}}},computed:{organizationOption:function(){return this.$store.state.info.organizationOption},tip:function(){return JSON.stringify(JSON.parse('{\n\t\t\t\t"name":"ff",\n\t\t\t\t"code":"34345",\n\t\t\t\t"children":{\n\t\t\t\t\t"name":"xx",\n\t\t\t\t\t"code":"3243"\n\t\t\t\t}\n\t\t\t}'),null,2)}},methods:{fetchTerminalOption:function(){var e=this;e.terminalModelOption&&e.terminalModelOption.length||this.$api(this.$cfg.API.application.model.query,{currPage:1,pageSize:1e3}).then(function(t){e.terminalModelOption=t.object.records}).catch(function(){})}}},m=(a(461),Object(c.a)(h,p,[],!1,null,null,null));m.options.__file="src/components/manage/terminal/terminal-list/form.vue";var v=m.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"ui-terminal-detail-dialog ui-form",attrs:{title:e.title,visible:e.visible,"lock-scroll":!1,"show-close":!1,"before-close":e.close,width:"600px"},on:{"update:visible":function(t){e.visible=t}}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"app-detail-title"},[e._v("终端："+e._s(e.detailData.terminalNO))]),e._v(" "),a("i",{staticClass:"iconfont icon-delete1",on:{click:e.close}})]),e._v(" "),a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"base"}},[a("base-info",{ref:"baseinfo",attrs:{disabled:"base"!=e.activeName,data:e.detailData}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"硬件信息",name:"hardware"}},[a("hardware-info",{ref:"hardwareinfo",attrs:{disabled:"hardware"!=e.activeName,data:e.detailData}})],1)],1)],1)},_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-detail-content c"},[a("div",{staticClass:"box c"},[a("div",{staticClass:"label"},[t._v("状态：")]),t._v(" "),a("div",{staticClass:"value"},[0==t.data.online?a("el-button",{attrs:{disabled:"",size:"mini"}},[t._v("离线")]):1==t.data.online?a("el-button",{attrs:{type:"success",plain:"",size:"mini"}},[t._v("在线")]):t._e()],1)]),t._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label"},[t._v("SN号：")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.data.terminalNO))])]),t._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label"},[t._v("型号：")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.data.model))])]),t._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[t._v("所属机构：")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.data.organizationName))])]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[t._v("最后在线：")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.data.lastConnectionTime))])])])};_._withStripped=g._withStripped=!0;var b={props:{data:{type:Object,default:function(){return{}}}},data:function(){return{inited:!1}},methods:{fetchData:function(){this.inited||(this.inited=!0,console.log("我是基本信息"))}}},w=Object(c.a)(b,_,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"box c"},[e("div",{staticClass:"label",attrs:{for:""}},[this._v("门店：")]),this._v(" "),e("div",{staticClass:"value"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"box c"},[e("div",{staticClass:"label",attrs:{for:""}},[this._v("品牌：")]),this._v(" "),e("div",{staticClass:"value"})])}],!1,null,null,null);w.options.__file="src/components/manage/terminal/terminal-list/detail/base-info.vue";var D=w.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-detail-content c"},[a("div",{staticClass:"box c"},[a("div",{staticClass:"label"},[t._v("Battery：")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.data.battery||"50%"))])]),t._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label"},[t._v("安卓版本：")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.data.s||"7.1.2"))])]),t._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label"},[t._v("基带版本：")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.data.s||"SCG235"))])]),t._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[t._v("固件版本：")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.data.s||"6.1.042"))])]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2)])};C._withStripped=!0;var y={props:{data:{type:Object,default:function(){return{}}}},data:function(){return{inited:!1}},methods:{fetchData:function(){this.inited||(this.inited=!0,console.log("我是硬件信息"))}}},N=Object(c.a)(y,C,[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[t._v("空间总大小：")]),t._v(" "),a("div",{staticClass:"value"},[t._v("9258M")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[t._v("可用空间：")]),t._v(" "),a("div",{staticClass:"value"},[t._v("9038M")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[t._v("网络模式：")]),t._v(" "),a("div",{staticClass:"value"},[t._v("以太网M")])])}],!1,null,null,null);N.options.__file="src/components/manage/terminal/terminal-list/detail/hardware-info.vue";var O={components:{BaseInfo:D,HardwareInfo:N.exports},data:function(){return{title:"详情",visible:!1,detailData:{},activeName:"base"}},methods:{show:function(t){var e=this;e.visible=!0,e.detailData=t,e.$nextTick(function(){e.$refs.baseinfo.fetchData()})},close:function(){this.visible=!1,this.reset()},reset:function(){this.activeName="base",this.$refs.baseinfo.inited=!1,this.$refs.hardwareinfo.inited=!1},handleClick:function(t){var e=t.paneName;"base"==e?this.$refs.baseinfo.fetchData():"hardware"==e&&this.$refs.hardwareinfo.fetchData()}}},x=(a(462),Object(c.a)(O,g,[],!1,null,null,null));x.options.__file="src/components/manage/terminal/terminal-list/detail/detail-dialog.vue";var $=x.exports,T=function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",[i("el-dialog",{staticClass:"c-m-terminal-applist-dialog ui-form",attrs:{title:a.title,visible:a.visible,"lock-scroll":!0,"before-close":a.close,fullscreen:"",top:"30px",width:"80%"},on:{"update:visible":function(t){a.visible=t}}},[i("div",{staticClass:"ui-table-content"},[i("search",{staticClass:"ui-search",attrs:{data:a.filter},on:{filterchange:a.filterChangeHandle}}),a._v(" "),i("el-table",{attrs:{data:a.listData,border:"",stripe:""}},[i("el-table-column",{attrs:{prop:"userName","min-width":"120px",label:"应用名","header-align":"center"},scopedSlots:a._u([{key:"default",fn:function(t){return[i("span",{staticClass:"app-img"},[i("img",{attrs:{src:t.row.picture,alt:""}})]),a._v(" "),i("span",{staticClass:"app-name"},[a._v(a._s(t.row.appName))])]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"type",label:"类别","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"state",label:"状态","header-align":"center",align:"center"},scopedSlots:a._u([{key:"default",fn:function(t){return[i("span",{class:a._f("colorFormatter")(t.row.state)},[a._v(a._s(a._f("stateFormatter")(t.row.state)))])]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"currVersion",label:"当前版本","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"availableVersion",label:"最新版本","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"installTime",label:"安装时间","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{label:"操作","min-width":"130px"},scopedSlots:a._u([{key:"default",fn:function(e){return[a.showInstallBtn(e.row)?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return a.handleApp("install",e.row)}}},[a._v("安装")]):a._e(),a._v(" "),a.showUpgradBtn(e.row)?i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return a.handleApp("upgrade",e.row)}}},[a._v("更新")]):a._e(),a._v(" "),a.showUninstallBtn(e.row)?i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return a.uninstallHanle("uninstall",e.row)}}},[a._v("卸载")]):a._e(),a._v(" "),i("el-dropdown",{attrs:{placement:"bottom-start"},on:{command:a.menuCommandHandle}},[i("el-link",{attrs:{type:"primary"}},[a._v("\n\t\t\t\t\t\t\t\t更多"),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a._v(" "),i("el-dropdown-menu",{staticClass:"ui-dropdown-menu",attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:["showLogTable",e.row]}},[a._v("日志列表")])],1)],1)]}}])})],1)],1),a._v(" "),i("div",{staticClass:"ui-page"},[i("el-pagination",{attrs:{"page-size":a.filter.pageSize,"current-page":a.filter.currPage,layout:"total, prev, pager, next, jumper",total:a.totalCount},on:{"current-change":a.pageChange,"update:currentPage":function(t){return a.$set(a.filter,"currPage",t)},"update:current-page":function(t){return a.$set(a.filter,"currPage",t)}}})],1)]),a._v(" "),i("log-list-dialog",{ref:"terminalapploglist"})],1)},F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"c-m-market-search search-bar"},[a("el-row",{attrs:{gutter:15}},[e._t("addbtn"),e._v(" "),a("el-col",{attrs:{xs:8,sm:5,lg:5,xl:3}},[a("el-input",{attrs:{"suffix-icon":"el-icon-search",clearable:"",placeholder:"请输入应用名搜索"},on:{change:e.filterFecth},model:{value:e.data.appName,callback:function(t){e.$set(e.data,"appName",t)},expression:"data.appName"}})],1),e._v(" "),a("el-col",{attrs:{xs:8,sm:5,lg:5,xl:3}},[a("el-input",{attrs:{"suffix-icon":"el-icon-search",clearable:"",placeholder:"请输入类别名搜索"},on:{change:e.filterFecth},model:{value:e.data.type,callback:function(t){e.$set(e.data,"type",t)},expression:"data.type"}})],1)],2)],1)};F._withStripped=T._withStripped=!0;var k={props:{data:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{filterFecth:function(){this.$emit("filterchange")}}},z=Object(c.a)(k,F,[],!1,null,null,null);z.options.__file="src/components/manage/terminal/app-list/search.vue";var S=z.exports,I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"c-m-log-list"},[a("el-dialog",{staticClass:"c-m-terminal-applist-dialog ui-form",attrs:{title:e.title,visible:e.visible,"lock-scroll":!0,"before-close":e.close,top:"5%",fullscreen:"",width:"70%"},on:{"update:visible":function(t){e.visible=t}}},[a("div",{staticClass:"ui-table-content"},[a("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:15}},[a("el-button",{staticClass:"ui-skin-btn ui-front-btn",attrs:{type:"primary",icon:"iconfont icon-add",size:"medium"},on:{click:e.createLog}},[e._v("生成日志")]),e._v(" "),a("el-col",{attrs:{xs:8,sm:5,lg:5,xl:3}},[a("el-date-picker",{staticClass:"daterange",attrs:{clearable:"",editable:!1,"value-format":"yyyy-MM-dd",type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.dateOption},on:{change:e.changeTime},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1)],1),e._v(" "),a("search",{staticClass:"ui-search",attrs:{data:e.filter},on:{filterchange:e.filterChangeHandle}}),e._v(" "),a("el-table",{attrs:{data:e.listData,border:"",stripe:""}},[a("el-table-column",{attrs:{prop:"filename",label:"文件名","header-align":"center",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"size",label:"大小","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t\t"+e._s(e._f("size")(t.row.size))+"\n\t\t\t\t\t")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"lastModified",label:"创建时间","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t\t"+e._s(e._f("dateFormat")(t.row.lastModified,"yyyy-MM-dd hh:mm:ss"))+"\n\t\t\t\t\t")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"70px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"primary",href:t.row.directUrl,download:""}},[a("i",{staticClass:"iconfont icon-download"}),e._v("下载")])]}}])})],1)],1)])],1)},E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"c-m-market-search search-bar"},[a("el-row",{attrs:{gutter:15}},[e._t("addbtn"),e._v(" "),a("el-col",{attrs:{xs:8,sm:5,lg:5,xl:3}},[a("el-input",{attrs:{"suffix-icon":"el-icon-search",clearable:"",placeholder:"请输入文件名搜索"},on:{change:e.filterFecth},model:{value:e.data.onlyFileName,callback:function(t){e.$set(e.data,"onlyFileName",t)},expression:"data.onlyFileName"}})],1)],2)],1)};E._withStripped=I._withStripped=!0;var L={props:{data:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{filterFecth:function(){this.$emit("filterchange")}}},P=Object(c.a)(L,E,[],!1,null,null,null);P.options.__file="src/components/manage/terminal/log-list/search.vue";var A=P.exports,M={mixins:[f.a],components:{Search:A},data:function(){return{visible:!1,bringData:{},TABLE_CONFIG:{field:{id:"id"},api:{query:this.$cfg.API.log.query}},filter:{filepath:"",pageSize:50,onlyFileName:""},createLogData:{beginTime:"",endTime:"",terminalNO:"",appName:""},autoLoad:!1,dateRange:[],dateOption:{disabledDate:function(t){return t.getTime()>Date.now()||t.getTime()<Date.now()-1296e6}}}},computed:{title:function(){var t=this.bringData.logType,e=this.bringData.terminalNO,a=this.bringData.appName;return"terminal"==t?"终端 ".concat(e," 日志"):"".concat(a,"--日志")}},methods:{show:function(t){this.bringData=t,this.createLogData.terminalNO=t.terminalNO,this.createLogData.appName=t.appName,this.fetchData(!0,{currPage:1})},close:function(){this.visible=!1,this.reset()},beforeFetch:function(){var t=this,e=t.bringData.logType;"terminal"==e?t.filter.filepath="a/b/".concat(t.bringData.terminalNO):"app"==e&&(t.filter.filepath="a/b/".concat(t.bringData.terminalNO,"/").concat(t.bringData.appName));var a=t.filter.onlyFileName,i=t.filter.filepath;t.filter.filepath=a?"".concat(i,"/").concat(a):i},afterFetch:function(t){this.listData=t.fileInfos||[],console.log(this.listData,"格式化之后的数据"),this.visible=!0},createLog:function(){var e=this;e.createLogData.beginTime&&e.createLogData.endTime?this.$api(this.$cfg.API.log.create,e.createLogData).then(function(t){e.$message.success("请求成功,等待后台生成日志")}).catch(function(){e._showErrMsg(err,"请求失败")}):e.$message.warning("请选择开始和结束日期")},changeTime:function(t){console.log(t),this.createLogData.endTime=t?(this.createLogData.beginTime=t[0],t[1]):this.createLogData.beginTime=""},reset:function(){var t=this;t.filter.filepath="",t.filter.onlyFileName="",t.createLogData.beginTime="",t.createLogData.endTime="",t.dateRange=[]}}},B=(a(463),Object(c.a)(M,I,[],!1,null,null,null));B.options.__file="src/components/manage/terminal/log-list/index.vue";var j=B.exports,R={mixins:[f.a],components:{Search:S,LogListDialog:j},data:function(){return{visible:!1,terminalData:{},TABLE_CONFIG:{field:{id:"id"},api:{query:this.$cfg.API.terminal.app.query}},filter:{pageSize:8,terminalNO:"",appName:"",type:""},autoLoad:!1}},computed:{title:function(){var t=this.terminalData.terminalNO;return"终端《".concat(t,"》-- 应用")}},filters:{colorFormatter:function(t){switch(t){case"notInstalled":return"";case"installed":return"success";case"upgrading":case"installing":return"info"}},stateFormatter:function(t){switch(t){case"notInstalled":return"未安装";case"installed":return"已安装";case"upgrading":return"更新中";case"installing":return"安装中"}}},methods:{showInstallBtn:function(t){var e=t.isUpgradeAndInstall,a=t.state;return e&&"notInstalled"==a},showUpgradBtn:function(t){var e=t.isUpgradeAndInstall,a=t.state;return e&&"installed"==a},showUninstallBtn:function(t){return"installed"==t.state},menuCommandHandle:function(t){if(t){var e=this[t[0]],a=t.slice(1);e&&e.apply(this,a)}},show:function(t){this.terminalData=t,this.filter.terminalNO=t.terminalNO,this.fetchData(!0,{currPage:1})},close:function(){this.visible=!1,this.reset()},afterFetch:function(){var t=this;if(t.listData&&t.listData.length){var e=t.listData[0].app;t.listData=e,console.log(t.listData,"格式化之后的数据")}t.visible=!0},handleApp:function(t,e){var a=this,i="";console.log(t,e),"install"==t?i="安装":"upgrade"==t&&(i="更新"),this.$api(this.$cfg.API.terminal.app.handle,{terminalNO:a.terminalData.terminalNO,appName:e.appName,operation:t}).then(function(t){a.fetchData(),a.$message.success("".concat(i,"请求成功,等待后台完成"))}).catch(function(t){a._showErrMsg(t,"".concat(i,"请求失败"))})},uninstallHanle:function(t,e){var a=this;a._asyncDialog("确定卸载 ".concat(e.appName," 么?"),"警告",{confirmButtonText:"确定",type:"warning",lockScroll:!1,confirmButtonClass:"el-button--danger",api:a.$cfg.API.terminal.app.handle,params:{terminalNO:a.terminalData.terminalNO,appName:e.appName,operation:t},success:function(){a.fetchData(),a.$message.success("卸载请求成功,等待后台完成")},fail:function(t){a._showErrMsg(t,"卸载请求失败")}})},showLogTable:function(t){var e=t;e.terminalNO=this.terminalData.terminalNO,e.logType="app",this.$refs.terminalapploglist.show(e)},reset:function(){this.filter.appName="",this.filter.type=""}}},G=(a(464),Object(c.a)(R,T,[],!1,null,null,null));G.options.__file="src/components/manage/terminal/app-list/index.vue";var q=G.exports,H={mixins:[f.a],components:{BreadCrumb:n.a,Search:u,TerminalDialog:v,TerminalDetail:$,AppListDialog:q,LogListDialog:j},data:function(){return{pageTitle:"终端明细",crumbData:["终端管理","终端明细"],filter:{terminalNO:"",model:"",organizationNo:null},TABLE_CONFIG:{field:{id:"id"},api:{query:this.$cfg.API.terminal.query}}}},methods:{menuCommandHandle:function(t){if(t){var e=this[t[0]],a=t.slice(1);e&&e.apply(this,a)}},showDetailDialog:function(t){this.$refs.terminaldetail.show(t)},showAdd:function(){this.$refs.terminaldialog.show(),this.$refs.terminaldialog.fetchTerminalOption()},showEdit:function(t){this.$refs.terminaldialog.show(t.id,t),this.$refs.terminaldialog.fetchTerminalOption()},showAppList:function(t){this.$refs.applistdialog.show(t)},showLogTable:function(t){var e=t;e.logType="terminal",this.$refs.terminalloglist.show(e)}},created:function(){this.$store.dispatch("info/fetchOrganization")}},U=Object(c.a)(H,i,[],!1,null,null,null);U.options.__file="src/components/manage/terminal/terminal-list/index.vue";e.default=U.exports}}]);