(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{406:function(t,e,a){t.exports=a(47)(105)},408:function(t,e,a){},409:function(t,e,a){"use strict";var i=a(13),o=a.n(i),s=a(76),n=a.n(s);e.a={data:function(){return{TABLE_CONFIG:{field:{id:"id"},api:{query:"",delete:""}},filter:{currPage:1,pageSize:15,sort:""},autoLoad:!0,loading:!0,listData:[],totalCount:0,pickedId:[],usePage:!0,useRouterQuery:!1}},beforeRouteUpdate:function(t,e,a){if(this.useRouterQuery){var i=t.query.page||1;this.filter.currPage=parseInt(i),this.fetchData(),a()}else a()},methods:{fetchData:function(t,e){var a=this;this.TABLE_CONFIG.api.query&&(!t&&this.loading||(this.beforeFetch&&this.beforeFetch(),e=o()({},this.filter,e),this.loading=!0,this.$api(this.TABLE_CONFIG.api.query,e,{showLoading:!0}).then(function(t){a.loading=!1,a.filter=e,a.parseData(t.object),a.afterFetch&&a.afterFetch(t.object)}).catch(function(t){a.loading=!1,a._showErrMsg(t)})))},parseData:function(t){this.usePage?(this.listData=t.records,this.totalCount=t.total):(this.listData=t,this.totalCount=t.length)},deleteData:function(t,e){if(this.TABLE_CONFIG.api.delete){var a=this,i=[],s="确定删除该条数据么?";if(t?i.push(t):(i=a.pickedId,s="确定删除选中的数据么?"),!i.length)return a.$message.warning("未选择任何数据"),!1;var n=o()({},e);n[a.TABLE_CONFIG.field.id]=i.join(","),a._asyncDialog(s,"警告",{confirmButtonText:"删除",type:"warning",confirmButtonClass:"el-button--danger",api:a.TABLE_CONFIG.api.delete,params:n,success:function(){a.$message({message:"删除成功",type:"success"}),a.usePage?a.fetchData():a.__delListData(i)}})}},__delListData:function(a){var i=this;this.listData.forEach(function(t,e){~a.indexOf(t[i.TABLE_CONFIG.field.id])&&i.listData.splice(e,1)})},selectRow:function(t){var e=this,a=[];t.forEach(function(t){a.push(t[e.TABLE_CONFIG.field.id])}),this.pickedId=a},sortData:function(t){t.order?this.filter.sort="ascending"==t.order?2:1:this.filter.sort="",this.fetchData()},pageChange:function(t){if(this.beforePageChange&&this.beforePageChange(t),this.useRouterQuery){var e=this.$route;if((e.query.page||1)==this.filter.currPage)return;var a={name:e.name,meta:o()({},e.meta),params:o()({},e.params),query:o()({},e.query)};a.query.page=t,e.name||(a.path=e.path),this.$router.push(a)}else this.fetchData();this.afterPageChange&&this.afterPageChange(t)},pushData:function(t){this.listData.unshift(t),this.listData.splice(this.filter.pageSize),this.totalCount++},updateData:function(i){var s=this,n=-1;this.listData.forEach(function(t,e){var a=t[s.TABLE_CONFIG.field.id];a&&a==i[s.TABLE_CONFIG.field.id]&&(n=e)}),-1!=n&&this.$set(this.listData,n,i)},filterChangeHandle:function(){this.beforeFilterChangeHandle&&this.beforeFilterChangeHandle(),this.fetchDataHandle(!1,{currPage:1})}},created:function(){this.fetchDataHandle=n()(this.fetchData,200);var t=this.$route.query.page;t&&(this.filter.currPage=parseInt(t)),this.autoLoad&&this.fetchData(!0)}}},410:function(t,e,a){"use strict";var i=a(408);a.n(i).a},411:function(t,e,a){"use strict";var i=a(13),s=a.n(i);e.a={data:function(){return{FORM_CONFIG:{field:{id:"id"},api:{info:"",add:"",edit:""}},id:0,inited:!1,formData:{},rules:{},dialogShow:!1,loading:!1,hasEdited:!1,saving:!1,labelWidth:"7em",unEdit:!1}},computed:{title:function(){return this.id?"编辑":"添加"}},watch:{formData:{handler:function(){this.inited&&(this.hasEdited=!0)},deep:!0}},methods:{show:function(t,e,a){this.id=t||0,this.unEdit=a||!1,this.dialogShow=!0,e?this.setFormData(e):this.id?this.fetchData():this.setFormData(this._defaultFormData)},close:function(t){var e=this;this.hasEdited?this.$confirm("表单未保存，确定要关闭吗？","警告",{confirmButtonText:"关闭",cancelButtonText:"点错了",type:"warning"}).then(function(){e.closeHandle(),"function"==typeof t&&t()}).catch(function(){}):(this.closeHandle(),"function"==typeof t&&t())},closeHandle:function(){this.dialogShow=!1,this.resetTimer=setTimeout(this.reset,300)},fetchData:function(){var e=this;if(this.FORM_CONFIG.api.info&&!this.loading){var t={};t[this.FORM_CONFIG.field.id]=this.id,this.loading=!0,this.$api(this.FORM_CONFIG.api.info,t).then(function(t){e.setFormData(t.object),e.loading=!1}).catch(function(t){e.loading=!1,e._showErrMsg(t)})}},setFormData:function(t){var e=this;this.formData=s()(!0,{},t),this.onSetFormData&&this.onSetFormData(),this.$nextTick(function(){e.inited=!0,e.$refs.form.clearValidate()})},save:function(){var e=this;this.saving||this.$refs.form.validate(function(t){t&&e.post()})},post:function(){var e=this,a=this.id?"edit":"add",t=this.FORM_CONFIG.api[a];if(t&&(!this.beforeSave||!1!==this.beforeSave())){this.saving=!0;var i=this.parsePostData?this.parsePostData():this.formData;this.$api(t,i).then(function(t){e.$emit(a,t.object),e.saving=!1,e.hasEdited=!1,e.$message.success("保存成功"),e.close(),e.onSuccess&&e.onSuccess(t)}).catch(function(t){e._showErrMsg(t),e.saving=!1,e.onFail&&e.onFail(t)})}},reset:function(){clearTimeout(this.resetTimer),this.inited=!1,this.hasEdited=!1;var t=this.$refs.form;t&&t.resetFields()}},created:function(){this._defaultFormData=s()(!0,{},this.formData)}}},412:function(t,e,a){"use strict";var i=function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{staticClass:"ui-bread-crumb"},[i("el-breadcrumb",a._l(a.data,function(t,e){return i("el-breadcrumb-item",{key:e},[a._v(a._s(t))])}),1)],1)};i._withStripped=!0;var s={props:{data:{type:Array,default:function(){return[]}}}},n=(a(410),a(46)),o=Object(n.a)(s,i,[],!1,null,null,null);o.options.__file="src/components/manage/common/bread-crumb.vue";e.a=o.exports},431:function(t,e,a){},432:function(t,e,a){},433:function(t,e,a){},434:function(t,e,a){},457:function(t,e,a){"use strict";var i=a(431);a.n(i).a},458:function(t,e,a){"use strict";var i=a(432);a.n(i).a},459:function(t,e,a){"use strict";var i=a(433);a.n(i).a},460:function(t,e,a){"use strict";var i=a(434);a.n(i).a},467:function(t,e,a){"use strict";a.r(e);var i=function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{directives:[{name:"title",rawName:"v-title",value:a.pageTitle,expression:"pageTitle"}],staticClass:"c-m-application-issue ui-box"},[i("bread-crumb",{attrs:{data:a.crumbData}}),a._v(" "),i("search",{staticClass:"ui-search",attrs:{data:a.filter},on:{filterchange:a.filterChangeHandle}}),a._v(" "),i("div",{staticClass:"ui-table-content"},[i("el-table",{attrs:{data:a.listData,border:"",stripe:""}},[i("el-table-column",{attrs:{prop:"userName",label:"应用名","header-align":"center"},scopedSlots:a._u([{key:"default",fn:function(t){return[i("span",{staticClass:"app-img"},[i("img",{attrs:{src:t.row.picture,alt:""}})]),a._v(" "),i("span",{staticClass:"app-name"},[a._v(a._s(t.row.appName))])]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"type",label:"类别","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"version",label:"版本号","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{width:"80",prop:"size",label:"大小","header-align":"center",align:"center"},scopedSlots:a._u([{key:"default",fn:function(t){return[i("span",{staticClass:"app-name"},[a._v(a._s(a._f("size")(t.row.size)))])]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"copyright",label:"版权","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"versionModifyTime",label:"更新时间","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{label:"操作","min-width":"130px"},scopedSlots:a._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return a.showDetail(e.row)}}},[a._v("详情")]),a._v(" "),e.row.isPublish?i("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){return a.issue(e.row)}}},[a._v("发布")]):i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return a.updateIssue(e.row)}}},[a._v("修改")]),a._v(" "),i("el-link",{attrs:{type:"primary"},on:{click:function(t){return a.showAllVersion(e.row)}}},[a._v("全部版本")])]}}])})],1)],1),a._v(" "),i("div",{staticClass:"ui-page"},[i("el-pagination",{attrs:{"page-size":a.filter.pageSize,"current-page":a.filter.currPage,layout:"total, prev, pager, next, jumper",total:a.totalCount},on:{"current-change":a.pageChange,"update:currentPage":function(t){return a.$set(a.filter,"currPage",t)},"update:current-page":function(t){return a.$set(a.filter,"currPage",t)}}})],1),a._v(" "),i("detail-dialog",{ref:"detaildialog"}),a._v(" "),i("issue-dialog",{ref:"issuedialog",on:{add:a.fetchData,edit:a.fetchData}}),a._v(" "),i("all-version-dialog",{ref:"allversiondialog"})],1)};i._withStripped=!0;var s=a(412),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"c-m-market-search search-bar"},[a("el-row",{attrs:{gutter:15}},[e._t("addbtn"),e._v(" "),a("el-col",{attrs:{xs:8,sm:5,lg:5,xl:3}},[a("el-input",{attrs:{"suffix-icon":"el-icon-search",clearable:"",placeholder:"请输入应用名搜索"},on:{change:e.filterFecth},model:{value:e.data.appName,callback:function(t){e.$set(e.data,"appName",t)},expression:"data.appName"}})],1),e._v(" "),a("el-col",{attrs:{xs:8,sm:5,lg:5,xl:3}},[a("el-input",{attrs:{"suffix-icon":"el-icon-search",clearable:"",placeholder:"请输入类别名搜索"},on:{change:e.filterFecth},model:{value:e.data.type,callback:function(t){e.$set(e.data,"type",t)},expression:"data.type"}})],1),e._v(" "),a("el-col",{attrs:{xs:8,sm:5,lg:5,xl:3}},[a("treeselect",{attrs:{noResultsText:e.noResultsText,noOptionsText:e.noOptionsText,placeholder:"机构选择",options:e.organizationOption,normalizer:e.normalizer},on:{input:e.filterFecth},model:{value:e.data.organizationNo,callback:function(t){e.$set(e.data,"organizationNo",t)},expression:"data.organizationNo"}})],1)],2)],1)};n._withStripped=!0;var o=a(403),r=a.n(o),l=(a(404),{components:{Treeselect:r.a},props:{data:{type:Object,default:function(){return{}}}},data:function(){return{noOptionsText:"暂无机构",noResultsText:"无对应搜索结果",normalizer:function(t){return{id:t.id,label:t.organizationName,children:t.children}}}},computed:{organizationOption:function(){return this.$store.state.info.organizationOption}},methods:{filterFecth:function(){this.$emit("filterchange")}}}),c=a(46),u=Object(c.a)(l,n,[],!1,null,null,null);u.options.__file="src/components/manage/application/issue/search.vue";var d=u.exports,p=a(409),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"ui-application-detail-dialog ui-form",attrs:{title:e.title,visible:e.visible,"lock-scroll":!1,"show-close":!1,"before-close":e.close,width:"520px"},on:{"update:visible":function(t){e.visible=t}}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"app-detail-title"},[e._v(e._s(e.detailData.appName))]),e._v(" "),a("i",{staticClass:"iconfont icon-delete1",on:{click:e.close}})]),e._v(" "),a("div",{staticClass:"app-detail-content c"},[a("div",{staticClass:"box c"},[a("div",{staticClass:"label"},[e._v("版本：")]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e.detailData.version))])]),e._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label"},[e._v("类别：")]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e.detailData.type))])]),e._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[e._v("大小：")]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e._f("size")(e.detailData.size)))])]),e._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[e._v("价格：")]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e.detailData.charge))])]),e._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[e._v("应用说明：")]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e.detailData.appDes))])]),e._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[e._v("版本说明：")]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e.detailData.versionDes))])]),e._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[e._v("兼容系统：")]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e.detailData.compatibleOperatingSystem))])]),e._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[e._v("兼容机型：")]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e.detailData.compatibleTerminalModel))])]),e._v(" "),a("div",{staticClass:"box c"},[a("div",{staticClass:"label",attrs:{for:""}},[e._v("版权：")]),e._v(" "),a("div",{staticClass:"value"},[e._v(e._s(e.detailData.copyright))])])])])};f._withStripped=!0;var h={data:function(){return{title:"详情",visible:!1,detailData:{}}},methods:{show:function(t){this.visible=!0,this.detailData=t},close:function(){this.visible=!1}}},v=(a(457),Object(c.a)(h,f,[],!1,null,null,null));v.options.__file="src/components/manage/application/issue/detail-dialog.vue";var m=v.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"c-m-application-issue-dialog ui-form",attrs:{title:e.title,visible:e.dialogShow,"lock-scroll":!1,"close-on-click-modal":!1,"before-close":e.close,width:"450px"},on:{"update:visible":function(t){e.dialogShow=t}}},[a("el-form",{ref:"form",attrs:{model:e.formData,"label-width":"80px","label-position":"right"}},[a("el-form-item",{attrs:{label:"机构选择",prop:"organizationNo"}},[a("treeselect",{attrs:{placeholder:"机构选择",noResultsText:e.noResultsText,noOptionsText:e.noOptionsText,multiple:!0,options:e.organizationOption,normalizer:e.normalizer},model:{value:e.formData.organizationNo,callback:function(t){e.$set(e.formData,"organizationNo",t)},expression:"formData.organizationNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"门店品牌",prop:"merchant"}},[a("el-input",{attrs:{type:"textarea",rows:"4",placeholder:"请按示例输入"},model:{value:e.formData.merchant,callback:function(t){e.$set(e.formData,"merchant",t)},expression:"formData.merchant"}}),e._v(" "),a("el-popover",{attrs:{placement:"right-start",width:"100",trigger:"hover","popper-class":"example-popper"}},[a("div",[a("pre",[e._v(e._s(e.tip))])]),e._v(" "),a("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[e._v("示例")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:e.close}},[e._v("关 闭")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",disabled:e.saving,loading:e.saving},on:{click:e.save}},[e._v("保 存")])],1)],1)};g._withStripped=!0;var _=a(12),b=a.n(_),D={mixins:[a(411).a],components:{Treeselect:r.a},data:function(){return{FORM_CONFIG:{field:{id:"id"},api:{add:this.$cfg.API.application.issue.add,edit:this.$cfg.API.application.issue.edit}},formData:{organizationNo:[],merchant:""},noOptionsText:"暂无机构",noResultsText:"无对应搜索结果",normalizer:function(t){return{id:t.id,label:t.organizationName,children:t.children}}}},computed:{organizationOption:function(){return this.$store.state.info.organizationOption},tip:function(){return JSON.stringify(JSON.parse('{\n\t\t\t\t"name":"ff",\n\t\t\t\t"code":"34345",\n\t\t\t\t"children":{\n\t\t\t\t\t"name":"xx",\n\t\t\t\t\t"code":"3243"\n\t\t\t\t}\n\t\t\t}'),null,2)}},methods:{fetchOrganization:function(){var a=this;this.$api(this.$cfg.API.application.organization.query).then(function(t){a.organizationData=t.object;var e=a.mapToArrayByKeys(a.organizationData,["records","children"]);a.organizationOption=e.records,console.log(e.records,"我是最终数据")}).catch(function(){})},mapToArrayByKeys:function(t,e){for(var a in t)"object"===b()(t[a])&&(t[a]=this.mapToArrayByKeys(t[a],e)),0<=e.indexOf(a)&&"object"===b()(t[a])&&(t[a]=Object.values(t[a]));return t}}},C=(a(458),Object(c.a)(D,g,[],!1,null,null,null));C.options.__file="src/components/manage/application/issue/issue-dialog.vue";var y=C.exports,w=function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{staticClass:"c-m-all-issue-version ui-form"},[i("el-dialog",{staticClass:"c-m-all-issue-version-dialog ui-form",attrs:{title:a.title,visible:a.visible,"lock-scroll":!1,"before-close":a.close,width:"80%"},on:{"update:visible":function(t){a.visible=t}}},[i("div",{staticClass:"ui-table-content"},[i("el-table",{attrs:{data:a.listData,border:"",stripe:""}},[i("el-table-column",{attrs:{prop:"userName",label:"应用名","header-align":"center"},scopedSlots:a._u([{key:"default",fn:function(t){return[i("span",{staticClass:"app-img"},[i("img",{attrs:{src:t.row.picture,alt:""}})]),a._v(" "),i("span",{staticClass:"app-name"},[a._v(a._s(t.row.appName))])]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"type",label:"类别","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"version",label:"版本号","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{width:"80",prop:"size",label:"大小","header-align":"center",align:"center"},scopedSlots:a._u([{key:"default",fn:function(t){return[i("span",{staticClass:"app-name"},[a._v(a._s(a._f("size")(t.row.size)))])]}}])}),a._v(" "),i("el-table-column",{attrs:{prop:"copyright",label:"版权","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{prop:"versionModifyTime",label:"更新时间","header-align":"center",align:"center"}}),a._v(" "),i("el-table-column",{attrs:{label:"操作","min-width":"130px"},scopedSlots:a._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return a.showDetail(e.row)}}},[a._v("详情")]),a._v(" "),e.row.isPublish?i("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){return a.issue(e.row)}}},[a._v("发布")]):i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return a.updateIssue(e.row)}}},[a._v("修改")])]}}])})],1)],1),a._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:a.close}},[a._v("取消")])],1)]),a._v(" "),i("detail-dialog",{ref:"versiondetaildialog"}),a._v(" "),i("issue-dialog",{ref:"versionissuedialog",on:{add:a.fetchData,edit:a.fetchData}})],1)};w._withStripped=!0;var x={mixins:[p.a],components:{DetailDialog:m,IssueDialog:y},data:function(){return{title:"全部版本",visible:!1,TABLE_CONFIG:{field:{id:"noticeId"},api:{query:this.$cfg.API.application.issue.queryAll}},filter:{appName:""},autoLoad:!1}},methods:{show:function(t){this.filter.appName=t.appName,this.fetchData(!0,{currPage:1})},close:function(){this.visible=!1},afterFetch:function(){var a=this;if(a.listData&&a.listData.length){var t=Object.values(a.listData[0].version_feature);t.forEach(function(t,e){t.appName=a.listData[0].appName,t.charge=a.listData[0].charge,t.type=a.listData[0].type,t.appDes=a.listData[0].appDes,t.createTime=a.listData[0].createTime}),a.listData=t,console.log(a.listData,"格式化之后的数据")}a.visible=!0},showDetail:function(t){this.$refs.versiondetaildialog.show(t)},issue:function(t){this.$refs.versionissuedialog.show(),this.$refs.versionissuedialog.formData.appName=t.appName,this.$refs.versionissuedialog.formData.version=t.version},updateIssue:function(t){this.$refs.versionissuedialog.show(t.id,t)}}},O=(a(459),Object(c.a)(x,w,[],!1,null,null,null));O.options.__file="src/components/manage/application/issue/more/all-issue-version.vue";var z=O.exports,N={mixins:[p.a],components:{BreadCrumb:s.a,Search:d,DetailDialog:m,IssueDialog:y,AllVersionDialog:z},data:function(){return{pageTitle:"应用发布",crumbData:["应用管理","应用发布"],filter:{appName:"",type:"",organizationNo:null},TABLE_CONFIG:{field:{id:"noticeId"},api:{query:this.$cfg.API.application.issue.query}},organizationData:{}}},methods:{showDetail:function(t){this.$refs.detaildialog.show(t)},issue:function(t){this.$refs.issuedialog.show(),this.$refs.issuedialog.formData.appName=t.appName,this.$refs.issuedialog.formData.version=t.version},updateIssue:function(t){console.log(t),this.$refs.issuedialog.show(t.id,t)},showAllVersion:function(t){this.$refs.allversiondialog.show(t)}},created:function(){this.$store.dispatch("info/fetchOrganization")}},$=(a(460),Object(c.a)(N,i,[],!1,null,null,null));$.options.__file="src/components/manage/application/issue/index.vue";e.default=$.exports}}]);